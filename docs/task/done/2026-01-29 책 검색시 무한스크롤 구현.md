# 에이전트 작업 절차

1. 아래 `## 개발자 요구사항` 섹션을 바탕으로 코드 베이스를 검토하고 작업을 준비한다.
2. 만약 마지막 섹션이 `## 개발자 요구사항 수정` 또는 `## 개발자 검토답변` 등 개발자의 섹션이라면 중간을 건너뛰고 해당 부분부터 작업하도록 한다.
3. 개발자의 의사결정이 필요한 내용이 있다면 문의할 내용을 이 파일의 마지막에 `## 에이전트 검토요청`으로 섹션을 추가하고 작업을 종료한다.
4. 작업을 완료한 경우 내용 이 파일의 마지막에 `## 에이전트 작업수행내용:{yyyy-MM-dd HH : MM}` 섹션을 추가하고 작업한 상세 내용을 작성한다.
5. 그밖의 일반적인 작업지침은 [ai_agent_guide.md](/docs/guide/ai_agent_guide.md) 을 확인 후 작업한다.

## 개발자 요구사항

- book 도메인 패키지를 주된 대상으로 한다.
- 현재 페이지 검색 방식으로 구현되어있다.
- 이를 오프셋기반의 무한스크롤로 구현하고자 한다.
- Page 타입이 아닌 Slice 타입을 사용하도록 변경한다.
- 외부 API로 책 정보를 가져올 때 ISBN에 비어있는 경우 필터 아웃한다.
- 결합도를 낮추기 위해 외부 API 책을 검색할때 반환타입을 현재 도메인 Book 엔티티를 사용하고 있으나 이를 ExternalBook 이라는 신규 VO로 정의하고 이것으로 변경한다.
- API 컨트롤러는 기존의 핸들러를 수정하여 사용한다.
- 현재 Book 엔티티는 ISBN 이 없는 상태를 허용하고 있으나 지금부터는 허용하지 않는다.

## 에이전트 작업수행내용:2026-01-29 15:05

- **도메인 모델 변경**: `Book` 엔티티에서 `isbn`을 필수 값으로 변경하고, `newOf` 메서드에 검증 로직을 추가했습니다.
- **VO 도입**: 외부 API 응답을 받기 위한 `ExternalBook` record를 추가하여 도메인 엔티티와의 결합도를 낮췄습니다.
- **무한 스크롤 구현**:
    - `ExternalBookSearcher` 및 `NaverBookSearcher`가 `Slice<ExternalBook>`을 반환하도록 수정했습니다.
    - 네이버 API 응답에서 ISBN이 없는 항목을 필터링하는 로직을 추가했습니다.
    - `BookQueryable` 및 `BookQueryService`가 `Slice<Book>`을 반환하도록 변경했습니다.
    - `BookApi`의 검색 엔드포인트를 `Slice<BookResponse>`를 반환하도록 수정했습니다.
- **테스트 코드 수정**:
    - `BookQueryServiceTest`, `BookApiTest`, `NaverBookSearcherTest`, `NaverBookSearcherApiTest` 등 관련 테스트 코드를 `Slice` 및
      `ExternalBook` 구조에 맞게 리팩토링했습니다.
    - 모든 관련 테스트가 성공적으로 통과함을 확인했습니다.