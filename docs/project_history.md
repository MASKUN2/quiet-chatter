# 프로젝트 개발 히스토리

본 문서는 프로젝트의 초기 단계부터 현재까지의 개발 흐름, 주요 기술적 의사결정, 그리고 트레이드오프에 대한 기록입니다.

## 작성방법

- 시간순으로 작성한다.
- `##`은 약 한달 정도의 기간에 해당하는 섹션이며 여러 작업을 묶는 역할이다.`## 기간의 제목 (yyyy-MM)`
- `###`은 하나의 작업내용을 기술하는 섹션이며 `### 작업제목 : yyyy-MM-dd` 형식으로 작성된다.
- 작업내용을 작성할때는 불필요한 수식여구 없이 서술형으로 작성한다.
- 문제와 갈등, 트레이드오프와 기술적 선택의 이유에 대해 작성한다.
- 작업내용을 작성할때는 구체적으로 본 프로젝트에서 작성된 클래스나 코드를 언급하지 않고 구조와 작동원리에 대해서 설명한다. 단, JDK이나 Spring 에서 제공하는 타입은 언급할 수 있다.

---

## 우아한 테크코스 오픈미션 (2025-11)

"Quiet Chatter: You Belong Here"
내향적인 독서가들을 위한 익명 독후감 소셜 네트워크 서비스를 목표로 시작되었습니다. 3주간의 프리코스 기간 동안 학습한 객체지향 원칙, TDD, 클린 코드를 실제 제품 레벨에 적용하는 것을 최우선 목표로 삼았습니다.

### 초기 인프라 및 기반 구축 : 2025-11-08

제한된 시간 내에 완성도 있는 프로토타입을 구축하기 위해 Java 21, Spring Boot, PostgreSQL, Thymeleaf와 같은 익숙한 기술 스택을 선정했습니다. React와 같은 SPA 프레임워크는 사용자 경험 면에서 유리하지만 높은 학습 곡선과 구축 비용을 고려하여, 백엔드 로직에 집중하고 UI 복잡도를 낮출 수 있는 Thymeleaf(SSR)를 선택했습니다. 호스팅 환경은 EC2 대비 비용 효율성과 관리 용이성이 뛰어난 AWS LightSail을 활용했으며, GitHub Actions와 Docker Compose를 기반으로 CI/CD 파이프라인을 구축하여 서버 환경의 일관성을 보장했습니다. 도메인 모델링에서는 분산 환경에서의 확장성과 식별력을 고려하여 일반적인 `Long` Auto Increment 대신 `UUID`를 ID 전략으로 도입했습니다. 테스트 환경은 로컬 H2 DB 대신 운영 환경과 동일한 PostgreSQL을 TestContainers로 구동하여 신뢰성을 확보했습니다.

### 외부 연동 및 테스트 고도화 : 2025-11-12

네이버 도서 검색 API 연동 시 비용과 시간이 소요되는 외부 통신 문제를 해결하기 위해 테스트 전략을 고도화했습니다. 외부 API 테스트는 `@Tag`를 사용하여 단위 테스트와 분리하고, `@RestClientTest`를 활용한 서버 모킹(Mocking)을 통해 안정적인 테스트 환경을 구축했습니다. 또한 복잡한 엔티티 생성 로직을 테스트 코드에서 분리하고 가독성을 높이기 위해 Instancio와 같은 테스트 픽스처 라이브러리를 도입했습니다. 도서 데이터의 정합성을 위해 이미 존재하는 도서는 정보를 갱신하고, 없는 경우 신규 등록하는 Merge or Persist 전략을 적용했습니다. 보안 측면에서는 가비아 도메인을 구입하고 Nginx 리버스 프록시와 Let's Encrypt를 활용한 HTTPS를 적용하여 데이터 전송의 안전성을 확보했습니다.

### 인증 및 연관관계 설계 : 2025-11-15

익명성을 보장하면서도 원활한 서비스를 제공하기 위해 Spring Security를 기반으로 커스텀 인증 시스템을 구축했습니다. 비로그인 사용자도 `Anonymous` 상태에서 특정 액션을 수행하면 `Guest` 권한으로 자동 승격되도록 필터를 구현했으며, Thymeleaf 환경에 맞춰 세션 기반 인증을 채택했습니다. JPA 연관관계 설계 시에는 애그리거트(Aggregate) 간의 결합도를 낮추기 위해 객체 참조 대신 ID 참조 방식을 선택했습니다. 이는 객체 그래프 탐색의 편리함을 일부 포기하는 트레이드오프가 있었지만, 도메인 경계를 명확히 하고 불필요한 연관 객체 생성을 방지하여 테스트 복잡도를 획기적으로 낮추는 효과를 얻었습니다. 단, 라이프사이클을 공유하는 강한 결합의 하위 엔티티는 객체 참조를 유지했습니다.

### 동시성 제어 및 성능 최적화 : 2025-11-18

트래픽 급증 시 발생할 수 있는 DB 락 경합과 성능 저하 문제를 해결하기 위해 좋아요(Like) 기능에 '지연된 쓰기' 전략을 도입했습니다. 요청 수신 시 즉시 `202 Accepted`를 응답하고 작업을 인메모리 큐에 적재한 뒤, 단일 백그라운드 스레드가 이를 배치 처리하도록 구현했습니다. 이 과정에서 JPA의 Dirty Checking이 유발하는 영속성 컨텍스트 관리 비용을 회피하기 위해 JDBC Template Batch Update를 사용하여 성능을 극대화했습니다. 또한 메모리 상에서 상쇄되는 좋아요(On/Off 반복) 요청을 전처리하여 DB 부하를 효율적으로 관리했습니다.

### 아키텍처 리팩토링 및 안정화 : 2025-11-23

보안 강화를 위해 Nginx 레벨에서 불법적인 리소스 요청을 차단하고 Rate Limiting을 적용하여 가용성 공격에 대비했습니다. 기존의 계층형 패키지 구조가 클래스 탐색을 어렵게 만드는 문제를 개선하기 위해 도메인 중심으로 패키지를 재구성했습니다. 모듈 간 불필요한 의존을 방지하기 위해 `public` 접근자를 최소화하고 `package-private`을 적극 활용하여 가시성을 제한했습니다. 또한 랜덤 북톡 추천 기능의 응답 속도를 보장하기 위해 Stale-While-Revalidate 캐싱 전략을 도입했습니다. 대량 데이터의 무작위 추천 성능을 위해 전체 정렬 대신 ID 추출 후 조회(Sampling) 방식을 적용했으며, `ThreadPoolTaskExecutor`를 활용한 비동기 캐시 갱신으로 응답성을 높였습니다.

---

## AI 에이전트 협업 고도화 (2026-01)

개발 중단 이후, AI 에이전트와의 협업을 통해 레거시 코드의 복잡도를 낮추고 유지보수성을 높이는 리팩토링과 신규 기능 개발을 재개했습니다.

### 프론트엔드/백엔드 분리 및 React 도입 : 2026-01-20

기존의 Thymeleaf 기반 서버 사이드 렌더링(SSR) 방식은 빠른 프로토타입 개발에는 유리했으나, 복잡한 사용자 인터랙션 구현과 모바일 환경 확장에 한계가 있었습니다. 이를 해결하기 위해 백엔드와 프론트엔드를 완전히 분리하는 아키텍처로 전환했습니다. 백엔드는 RESTful API 제공에 집중하도록 경량화하고, 프론트엔드는 React와 TypeScript, Vite를 도입하여 별도의 프로젝트(quiet-chatter-front-end)로 구축했습니다. 이를 통해 사용자 경험을 개선하고, 각 영역의 관심사를 명확히 분리하여 유지보수성과 개발 효율성을 높였습니다.

### 인증 아키텍처 개편 및 최적화 : 2026-01-21
기존의 세션 기반 인증을 모바일 확장성과 서버 무상태성(Stateless)을 고려하여 JWT(JSON Web Token) 기반으로 전면 개편했습니다. 이 과정에서 매 요청마다 발생하는 DB 조회 부하를 해소하기 위해 Redis를 도입하고 Look-aside 패턴의 캐싱 전략을 적용하여 인증 처리 속도를 개선했습니다. 또한, 비로그인 사용자의 진입 장벽을 낮추는 '게스트 자동 승급' 메커니즘을 필터 레벨에서 재설계하여, 인증 토큰이 없는 요청도 투명하게 임시 계정으로 전환되고 토큰이 발급되도록 구현했습니다.

### 톡 도메인 단순화 : 2026-01-25

JDBC Batch 처리나 단순 조회 시 복잡도를 높이는 과도한 VO(Value Object) 사용과 임베디드 타입 문제를 해결했습니다. 임베디드 타입으로 관리되던 시간 정보를 직관적인 `LocalDate` 타입의 필드로 변경하고, 별도의 객체로 관리되던 반응 카운트를 원시 타입 필드로 전환하여 구조를 단순화했습니다. 또한 상태 관리를 명확히 하기 위해 숨김 여부를 나타내는 `boolean` 필드를 추가했습니다.

### 자동 숨김 처리 : 2026-01-25

데이터 규모를 고려하여 복잡한 Spring Batch 대신 Spring Scheduling과 JPA Bulk Update(`@Modifying`)를 활용한 효율적인 자동 숨김 처리를 구현했습니다. 조회 성능을 보장하기 위해 숨김 날짜와 숨김 여부 컬럼에 복합 인덱스를 추가하여 대량 데이터 처리 시의 성능 저하를 예방했습니다.

### 기본 엔티티 및 시간 타입 변경 : 2026-01-25

타임존 처리에 엄격한 `Instant` 대신, 로컬 타임존(KST) 기준의 비즈니스 로직 처리에 적합한 `LocalDateTime`으로 시간 타입을 변경하여 개발 편의성과 직관성을 높였습니다. 또한 모든 엔티티의 상위 클래스에 마지막 수정 시간을 추적하는 필드를 추가하여 데이터 변경 추적 기능을 강화했습니다.

### 톡 수정 및 삭제 기능 : 2026-01-26

톡 내용 수정 시 숨김 날짜를 자동으로 연장하여 컨텐츠의 수명을 늘리는 정책을 구현했습니다. 삭제 기능은 실제 데이터를 삭제하는 대신 숨김 처리를 하는 Soft Delete 방식을 적용하여 데이터 보존성을 확보했습니다. 수정 여부 판단 로직은 별도의 컬럼을 두는 대신 마지막 수정 시간 필드의 존재 여부로 확인하도록 변경하여 데이터 중복을 제거하고 효율성을 높였습니다.

### 서브도메인 쿠키 처리 및 인증 안정화 : 2026-01-31

프론트엔드와 백엔드의 도메인 분리(quiet-chatter.com / api.quiet-chatter.com) 환경을 지원하기 위해 쿠키 설정을 고도화했습니다. 기존의 하드코딩된 쿠키 설정 대신 `AppCookieProperties`를 도입하여 환경별(local/prod)로 Domain, Secure, SameSite 정책을 유연하게 관리하도록 개선했습니다. 또한 `ResponseCookie`를 활용해 서브도메인 간 공유 가능한 쿠키를 발급하도록 수정했습니다. 인증 안정성을 높이기 위해 Access Token이 만료되거나 누락된 경우에도 Refresh Token이 유효하다면 자동으로 재인증을 시도하는 Fallback 메커니즘을 추가하여 사용자 경험을 끊김 없이 유지하도록 보완했습니다.